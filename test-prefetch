#!/usr/bin/env sh

set -e

./clean

nix-shell --command \
          'PYTHONPATH=${PWD}/src:${PYTHON_PATH} \
               py.test \
               --cov=nix_prefetch_github \
               --cov-report html:coverage/html \
               --cov-report term'

nix-build test-exec.nix \
          -A interpreter \
          -o build-package

build-package/bin/nix-prefetch-github \
    seppeljordan \
    pypi2nix
